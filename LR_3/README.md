# Лабораторная работа №4: Методы снижения размерности. Регуляризация логистической регрессии.
## Вариант 5
### Задание.
-  Данные своего варианта (см. таблицу ниже) разделить на выборку для построения 
моделей (85%) и отложенные наблюдения (15%). Оставить в таблице только указанные в
варианте переменные. Отложенные наблюдения использовать только для прогноза по 
лучшей модели.
-  Провести предварительный и корреляционный анализ данных с помощью статистик и
графиков из этой лабораторной.
-  Снизить размерность пространства объясняющих переменных методом, указанным в
варианте. Обосновать количество главных компонент. Построить модель логистической 
регрессии на преобразованном пространстве объясняющих переменных. Оценить 
точность модели методом перекрёстной проверки.
- Провести регуляризацию модели логистической регрессии методом, указанным в 
варианте. Подобрать оптимальное значение гиперпараметра методом перекрёстной
проверки. Построить график сжатия параметров модели.
- Выбрать наиболее точную модель из полученных в пунктах 3 и 4, сделать по ней прогноз
на отложенные наблюдения, оценить точность этого прогноза.
### Данные: https://raw.githubusercontent.com/aksyuk/MTML/main/Labs/data/winequality-white_for_lab.csv
- Зависимая переменная - Y
- Объясняющие переменные: fixed.acidity, volatile.acidity, citric.acid, residual.sugar, chlorides, free.sulfur.dioxide, pH, sulphates, alcohol
- Метод снижения размерности: PCR
- Метод регуляризации: ридж-регрессия
#### Выполнение:
1. Считали данные из файла, удалили ненудные столбцы. Разделили выборку на 2 части: обучающая, тестовая.
2. Провели предварительный аанализ данных: описательная статистика (значения объясняющих переменных положительные, масштабы измерения отличаются. Для работы с методами снижения размерности и регуляризации понадобится стандартизация значений), Визуализация разброса переменных внутри классов (На графиках отличие в медианах и разбросе между классами прослеживается практически по всем объясняющим переменным. Меньше всего различаются коробчатые диаграммы по переменной fixed_acidity, chlorides, free_sulfur_dioxide, volatile_acidity).
3. Корреляционный анализ: Между объясняющими переменными обнаруживаются как прямые, так и обратные линейные взаимосвязи. Выведем все значимые коэффициенты в одной таблице и определим минимальный / максимальный из них.
4. Методы снижения резмерности (PCR): Количество главных компонент было выбрано равное 6, но для построения графика были взяты 2 самые основные компоненты.
5. Построена модель логистической регрессии на преобразованном пространстве объясняющих переменных. Точность модели методом перекрёстной проверки получилась равная Acc = 0.76.
6. Методы сжатия (Ридж-регрессия):  Из-за того, что классы 0 и 1 в Y не сбалансированы, ридж-регрессия увидела только один из классов и была построена на нем. Подобран гиперпараметр и построен график сжатия параметров модели. Модель, построенная методом ридж - регрессии оказалась наиболее точной. Acc = 1
7. На ридж - регрессии модели был сделан прогноз на отложенные наблюдения и оценена точность.
